<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Code Showcase - Cameron Patterson</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.css" rel="stylesheet" />
</head>

<body>
  <div class="container">
    <h1>Code Showcase</h1>

    <nav class="top-nav">
      <a href="index.html#about">About</a>
      <a href="index.html#projects">Projects</a>
      <a href="code.html">Code Showcase</a>
      <a href="contact.html#contact">Contact</a>
    </nav>

    <div class="page-wrapper">
      <nav class="sidebar-nav">
        <ul>
          <li><a href="#dynamic-world-system">Dynamic World System</a></li>
          <li><a href="#burnout-timer">Burnout Timer System</a></li>
          <li><a href="#burnout-coffeepickup">Burnout Coffee Pickup</a></li>
        </ul>
      </nav>

      <main class="content-area">
        <!-- Projects Section -->
        <section id="projects">
          <h2>Code Examples</h2>
          <p class="project-textdescription">Click a section to expand and view the system breakdowns.</p>

          <div class="project">
            <!-- Dynamic World System -->
            <div class="project-header collapsible">
              <h3 id="dynamic-world-system">Horror Fishing: Dynamic World System</h3>
              <span class="project-date">June 2025</span>
              <span class="toggle-icon">▼</span>
            </div>
            <div class="project-content">
              <p>
                This system controls the time of day, weather, sun, and moon transitions
                in a dynamic world environment.
              </p>
              <pre><code class="language-csharp">
// DynamicWorldSystem.cs (snippet)
public class DynamicWorldSystem : MonoBehaviour {
    public static DynamicWorldSystem Instance { get; private set; }
    public TimeOfDaySystem timeOfDaySystem = new TimeOfDaySystem();
    public WeatherSystem weatherSystem = new WeatherSystem();

    void Update() {
        timeOfDaySystem.UpdateTime();
        weatherSystem.UpdateWeather(timeOfDaySystem.CurrentTimeOfDay);
    }
}
              </code></pre>
            </div>
          </div>

          <div class="project">
            <!-- Burnout Coffee Counter -->
            <div class="project-header collapsible">
              <h3 id="burnout-timer">Burnout: Game Timer System</h3>
              <span class="project-date">May 2025</span>
              <span class="toggle-icon">▼</span>
            </div>
            <div class="project-content">
              <p>This script is used to track the current timer and calculate reductions in time when a coffee is picked up.</p>
              <pre><code class="language-csharp">
// CountdownTimer.cs (snippet)
public class CountdownTimer : MonoBehaviour 
{
    //Variable declarations
    [SerializeField] private GameObject gameOverScreen;
    [SerializeField] private EndGameScript endGameScript;

    private FirstPersonController firstPersonController;
    private FootstepSounds footstepSounds;

    public TextMeshProUGUI timerText;

    //Timer Variables
    public float startTime = 180f; // 3 minutes
    private float adjustedStartTime;
    private float currentTime;
    private bool isTimerRunning = false;

    //Time Reduction Variables
    private int coffeeCount = 0;
    public float baseReduction = 20f; // Base reduction time in seconds
    public float exponent = 1.5f; // Exponent for the reduction formula

    void Update()
    {
        if (isTimerRunning)
        {
            currentTime -= Time.deltaTime; // Decrease the timer by the time passed since last frame

            if (currentTime <= 0 && endGameScript.gameEnded == false)
            {
                currentTime = 0; // Ensure timer does not go below zero
                isTimerRunning = false;
                Debug.Log("Timer finished!");
                timerText.gameObject.SetActive(false); // Hide timer text when finished
                ShowGameOverScreen(); // Show game over screen when timer ends
            }
            else if (currentTime <= 0 && endGameScript.gameEnded == true) // If the game has already ended, do not show the game over screen again
            {
                currentTime = 0; 
                isTimerRunning = false;
                Debug.Log("Timer finished!");
                timerText.gameObject.SetActive(false);
            }

            UpdateHUD(); // Update the timer display
        }
    }

    void UpdateHUD()
    {
        int minutes = Mathf.FloorToInt(currentTime / 60f); // Calculate minutes
        int seconds = Mathf.FloorToInt(currentTime % 60f); // Calculate seconds
        timerText.text = $"Break Ends In: {minutes:00}:{seconds:00}"; // Format the timer text
    }

    public void DrinkCoffee() // Method to handle coffee consumption
    {
        firstPersonController.UnlockSprintForDuration(10); // Unlock sprint for 10 seconds
        footstepSounds.ActivateCoffeeEffect(10f); // Activate coffee effect for 10 seconds (Increases footstep sound pitch to simulate energy boost)
        coffeeCount++; // Increment coffee count

        float reduction = baseReduction * Mathf.Pow(coffeeCount, exponent); // Calculate time reduction based on coffee count
        adjustedStartTime = Mathf.Max(10f, startTime - reduction); // Clamp to avoid negative time
        currentTime = adjustedStartTime; // Restart timer at adjusted time

        //Debug.Log($"Coffee: {coffeeCount}, New Time: {adjustedStartTime:F1}s"); // Log the coffee count and new time for debugging
    }
}
              </code></pre>
            </div>
          </div>

          <div class="project">
            <!-- Burnout Coffee Counter -->
            <div class="project-header collapsible">
              <h3 id="burnout-coffeepickup">Burnout: Coffee Pickup</h3>
              <span class="project-date">May 2025</span>
              <span class="toggle-icon">▼</span>
            </div>
            <div class="project-content">
              <p>This script is used to detect when a coffee is picked up</p>
              <pre><code class="language-csharp">
// CoffeePickup.cs (snippet)
public class CoffeePickup : MonoBehaviour
{
    private string playerTag = "Player";

    FootstepSounds footstepSounds; // Reference to FootstepSounds script for sound effects

    [Header("Audio Setup")]
    public AudioClip pickupSound; // Assign in Inspector
    public float volume = 1.0f;

    // Reference to the CountdownTimer script
    public CountdownTimer countdownTimer;

    public TextMeshProUGUI coffeeTextObject;
    public string coffeeMessage;

    private FirstPersonController firstPersonController;

    private MeshRenderer meshRenderer;
    private BoxCollider boxCollider;

    void Start()
    {
        coffeeTextObject.gameObject.SetActive(false);

        // If not assigned in Inspector, try to find the timer in the scene
        if (countdownTimer == null)
        {
            countdownTimer = FindObjectOfType<CountdownTimer>();
        }

        firstPersonController = GameObject.FindGameObjectWithTag("Player").GetComponent<FirstPersonController>();

        meshRenderer = GetComponent<MeshRenderer>();
        boxCollider = GetComponent<BoxCollider>();
    }

    void OnTriggerEnter(Collider other)
    {
        if (other.CompareTag(playerTag))
        {
            StartCoroutine(CoffeeTextPopUp());

            // Add any pickup sounds/animations or other behaviour (player stats increase, add coffee count to player)
            AudioSource playerAudio = other.GetComponent<AudioSource>();

            meshRenderer.enabled = false; // Hide the coffee mesh renderer
            boxCollider.enabled = false; // Disable the coffee collider

            playerAudio.PlayOneShot(pickupSound);

            // Tell the timer a coffee was picked up to calculate the new time
            if (countdownTimer != null)
            {
                countdownTimer.DrinkCoffee();
            }
        }
    }

    private IEnumerator CoffeeTextPopUp()
    {
        coffeeTextObject.gameObject.SetActive(true);

        yield return new WaitForEndOfFrame();

        coffeeTextObject.text = coffeeMessage; // Customisable text set in the Inspector for each coffee pickup. Useful to assign text for specific coffee pickups. e.g. the broom closet coffee text "who put this in the broom closet?!".

        yield return new WaitForSeconds(5); // Wait for 5 seconds before hiding the text

        coffeeTextObject.gameObject.SetActive(false); // Hide the text after 5 seconds

        if (!gameObject.CompareTag("EndCoffee"))
        {
            Destroy(gameObject); // Destroy the coffee pickup object after displaying the text, the coffee pickup mesh is already hidden in void OnTriggerEnter, this just cleans up the objects in scene.
        }
    }
}
              </code></pre>
            </div>
          </div>

          <!-- Add more systems here -->

        </section>

        <p><a href="index.html">← Back to Portfolio</a></p>
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-csharp.min.js"></script>
    <script src="projectcontent.js"></script>
  </div>
</body>
</html>
